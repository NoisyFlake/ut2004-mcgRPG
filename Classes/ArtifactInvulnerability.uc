class ArtifactInvulnerability extends RPGArtifact;

var() Material EffectOverlay;


function BotConsider()
{

	if (Instigator.Controller.Adrenaline < 30)
		return;

	if (bActive && (Instigator.Controller.Enemy == None || !Instigator.Controller.CanSee(Instigator.Controller.Enemy)))
		Activate();
	else if ( !bActive && Instigator.Controller.Enemy != None
		&& Instigator.Health < 0.7*Instigator.Healthmax && Instigator.Controller.CanSee(Instigator.Controller.Enemy) && NoArtifactsActive() &&
        FRand() < 0.7 )
		Activate();
}

state Activated
{
	function BeginState()
	{
		InstigatorController.bGodMode = true;
		Instigator.SetOverlayMaterial(EffectOverlay, Instigator.Controller.Adrenaline / CostPerSec, true);
		bActive = true;
	}

	function EndState()
	{
		if (Instigator != None)
			Instigator.SetOverlayMaterial(EffectOverlay, -1, true);
		if (InstigatorController != None)
		    InstigatorController.bGodMode = false;
		super.EndState();
	}
}

function reset()
{
    gotostate('');
}

defaultproperties
{
     EffectOverlay=Shader'UTRPGTextures.Overlays.InvulnerabilityOverlay'
     CostPerSec=40
     MinActivationTime=2.500000
     Index=3
     PickupClass=Class'mcgRPG1_9_9_1.ArtifactInvulnerabilityPickup'
     IconMaterial=Texture'UTRPGTextures.Icons.InvulnerabilityIcon'
     ItemName="Globe of Invulnerability"
}
